app = "bot-quote-discord-gfly"
primary_region = "ams"

# ============================
# Build Configuration
# ============================
[build]
  dockerfile = "Dockerfile"

# ============================
# Deployment Strategy
# Discord bot can run multiple machines safely
# Rolling deploy = zero downtime
# ============================
[deploy]
  strategy = "rolling"
  max_unavailable = 0

# ============================
# Environment Variables
# Secrets are injected via:
# fly secrets set ...
# ============================
[env]
  PYTHONUNBUFFERED = "1"

  DISCORD_BOT_TOKEN = "${DISCORD_BOT_TOKEN}"
  BANLU_CHANNEL_ID = "${BANLU_CHANNEL_ID}"
  HOLIDAYS_CHANNEL_IDS = "${HOLIDAYS_CHANNEL_IDS}"

# ============================
# Virtual Machine Configuration
# Free tier friendly:
# shared CPU + 512 MB RAM
# ============================
[[vm]]
  cpu_kind = "shared"
  cpus = 1
  memory = "512mb"

  # Bot must always stay online
  auto_restart = true
  auto_stop = false

# ============================
# Logs Configuration
# ============================
[logs]
  format = "json"
